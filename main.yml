name: zgpt-core-mock-config
version: 1.0.0
port: 22222
cors:
  - "http://localhost:8080"
  - "http://localhost:3000"
  - "http://localhost:3001"
description: ZGPT - Core API *mock*
endpoints:
  - url: [GET, /ping]
    responses: [["*", 200, { message: "pong" }]]

  - url: [GET, "/user/(?P<id>\\d+)"]
    responses:
      - [{ params: { id: "1" } }, 200, { id: 1, name: "Joe Doe" }]
      - [{ params: { id: "2" } }, 200, { id: 2, name: "Jane Doe" }]
      - ["*", 404, { message: "User not found" }]

  - url: [POST, /auth/login]
    responses:
      - [{ body: { username: "joe", password: "123456" } }, 200, {access_token: "eyjjjj.qweqwe.asdasd", token_type: "bearer"}]
      - ["*", 401, { message: "Invalid credentials" }]
  
  - url: [POST, /session]
    sideEffects:
      - type: create
        entity: session
        data: { id: _AUTONUM_, created: _NOW_, messages: [] }
    responses: 
      - [{isLoggedIn: true}, 200, {}]
      - ["*", 401, { message: "Unauthorized" }]
    childs:
      - url: [POST, "/(?P<id>\\d+)/message"]
        sideEffects:
          - type: plugin:chat:update
            entity: session
            property: { key: messages, action: push, searchBy: id }
            data: { id: _AUTONUM_, created: _NOW_, content: [] }
            
        responses: 
          - [{ body: { message: "Hello World!" } }, 200]
          - ["*", 401, { message: "Unauthorized" }]